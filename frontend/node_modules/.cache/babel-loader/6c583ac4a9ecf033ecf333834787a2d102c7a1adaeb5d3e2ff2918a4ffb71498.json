{"ast":null,"code":"import{API_BASE_URL}from'../config';import{useState,useEffect}from'react';import{useAuth}from'../contexts/AuthContext';import{useNavigate}from'react-router-dom';import{getCookie}from\"../utils/cookies\";import'./Profile.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Profile=()=>{// Incluye deleteUser del contexto\nconst{user,updateUser,deleteUserData,logout,deleteUser}=useAuth();const[formData,setFormData]=useState({username:'',email:''});const[loading,setLoading]=useState(false);const[error,setError]=useState('');const[success,setSuccess]=useState('');const navigate=useNavigate();useEffect(()=>{if(user){setFormData({username:user.username,email:user.email});}},[user]);const handleChange=e=>{setFormData({...formData,[e.target.name]:e.target.value});};const handleSubmit=async e=>{e.preventDefault();if(formData.username===user.username&&formData.email===user.email){setError('No hay cambios para guardar');return;}if(!window.confirm('¿Estás seguro de que quieres actualizar tu información?')){return;}setLoading(true);setError('');try{await updateUser({username:formData.username,email:formData.email});setSuccess('Información actualizada correctamente');}catch(err){setError(err.message);setSuccess('');}finally{setLoading(false);}};// Usa la función deleteUser del contexto\nconst handleDelete=async()=>{if(window.confirm('¿Estás seguro de que quieres eliminar tu cuenta? Esta acción no se puede deshacer.')){try{await deleteUser();logout();navigate('/login');}catch(err){setError(err.message);}}};const handleDeleteData=async()=>{if(window.confirm('¿Estás seguro de que quieres borrar todos tus datos (diarios y chats)? Esta acción no se puede deshacer.')){try{await deleteUserData();window.location.reload();}catch(err){setError(err.message);}}};if(!user)return/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"});return/*#__PURE__*/_jsx(\"div\",{className:\"profile-page-wrapper\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"profile-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"profile-header\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Tu Perfil\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"user-info\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Usuario:\"}),\" \",user.username]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Email:\"}),\" \",user.email]})]})]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"profile-form\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Actualizar Informaci\\xF3n\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"username\",children:\"Nombre de usuario\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"username\",name:\"username\",value:formData.username,onChange:handleChange,required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"email\",children:\"Email\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",id:\"email\",name:\"email\",value:formData.email,onChange:handleChange,required:true})]}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"error-message\",children:error}),success&&/*#__PURE__*/_jsx(\"div\",{className:\"success-message\",children:success}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:loading,children:loading?'Guardando...':'Guardar Cambios'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"danger-zone\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Zona Peligrosa\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleDeleteData,className:\"delete-data-button\",children:\"Borrar Todos Mis Datos\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleDelete,className:\"delete-button\",children:\"Eliminar Cuenta\"})]})]})});};export default Profile;","map":{"version":3,"names":["API_BASE_URL","useState","useEffect","useAuth","useNavigate","getCookie","jsx","_jsx","jsxs","_jsxs","Profile","user","updateUser","deleteUserData","logout","deleteUser","formData","setFormData","username","email","loading","setLoading","error","setError","success","setSuccess","navigate","handleChange","e","target","name","value","handleSubmit","preventDefault","window","confirm","err","message","handleDelete","handleDeleteData","location","reload","children","className","onSubmit","htmlFor","type","id","onChange","required","disabled","onClick"],"sources":["/home/ubuntu/EmberLight_Projecte2/frontend/src/pages/Profile.js"],"sourcesContent":["import { API_BASE_URL } from '../config';\nimport { useState, useEffect } from 'react';\nimport { useAuth } from '../contexts/AuthContext';\nimport { useNavigate } from 'react-router-dom';\nimport { getCookie } from \"../utils/cookies\";\nimport './Profile.css';\n\nconst Profile = () => {\n  // Incluye deleteUser del contexto\n  const { user, updateUser, deleteUserData, logout, deleteUser } = useAuth();\n  const [formData, setFormData] = useState({\n    username: '',\n    email: ''\n  });\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n  const [success, setSuccess] = useState('');\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    if (user) {\n      setFormData({\n        username: user.username,\n        email: user.email\n      });\n    }\n  }, [user]);\n\n  const handleChange = (e) => {\n    setFormData({\n      ...formData,\n      [e.target.name]: e.target.value\n    });\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n\n    if (formData.username === user.username && formData.email === user.email) {\n      setError('No hay cambios para guardar');\n      return;\n    }\n    if (!window.confirm('¿Estás seguro de que quieres actualizar tu información?')) {\n      return;\n    }\n\n    setLoading(true);\n    setError('');\n    \n    try {\n      await updateUser({\n        username: formData.username,\n        email: formData.email\n      });\n      setSuccess('Información actualizada correctamente');\n    } catch (err) {\n      setError(err.message);\n      setSuccess('');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Usa la función deleteUser del contexto\n  const handleDelete = async () => {\n    if (window.confirm('¿Estás seguro de que quieres eliminar tu cuenta? Esta acción no se puede deshacer.')) {\n      try {\n        await deleteUser();\n        logout();\n        navigate('/login');\n      } catch (err) {\n        setError(err.message);\n      }\n    }\n  };\n\n  const handleDeleteData = async () => {\n    if (window.confirm('¿Estás seguro de que quieres borrar todos tus datos (diarios y chats)? Esta acción no se puede deshacer.')) {\n      try {\n        await deleteUserData();\n        window.location.reload();\n      } catch (err) {\n        setError(err.message);\n      }\n    }\n  };\n\n  if (!user) return <div>Loading...</div>;\n\n  return (\n    <div className=\"profile-page-wrapper\">\n      <div className=\"profile-container\">\n        <div className=\"profile-header\">\n          <h2>Tu Perfil</h2>\n          <div className=\"user-info\">\n            <p><strong>Usuario:</strong> {user.username}</p>\n            <p><strong>Email:</strong> {user.email}</p>\n          </div>\n        </div>\n\n        <form onSubmit={handleSubmit} className=\"profile-form\">\n          <h3>Actualizar Información</h3>\n          \n          <div className=\"form-group\">\n            <label htmlFor=\"username\">Nombre de usuario</label>\n            <input\n              type=\"text\"\n              id=\"username\"\n              name=\"username\"\n              value={formData.username}\n              onChange={handleChange}\n              required\n            />\n          </div>\n\n          <div className=\"form-group\">\n            <label htmlFor=\"email\">Email</label>\n            <input\n              type=\"email\"\n              id=\"email\"\n              name=\"email\"\n              value={formData.email}\n              onChange={handleChange}\n              required\n            />\n          </div>\n\n          {error && <div className=\"error-message\">{error}</div>}\n          {success && <div className=\"success-message\">{success}</div>}\n\n          <button type=\"submit\" disabled={loading}>\n            {loading ? 'Guardando...' : 'Guardar Cambios'}\n          </button>\n        </form>\n\n        <div className=\"danger-zone\">\n          <h3>Zona Peligrosa</h3>\n          <button \n            onClick={handleDeleteData} \n            className=\"delete-data-button\"\n          >\n            Borrar Todos Mis Datos\n          </button>\n          <button \n            onClick={handleDelete} \n            className=\"delete-button\"\n          >\n            Eliminar Cuenta\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Profile;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}